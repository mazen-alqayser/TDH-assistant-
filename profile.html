<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <title>الملف الشخصي - TDH</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', 'Cairo', sans-serif;
            /* Transition for background color change */
            transition: background-color 0.3s ease;
        }
        /* Configuration for Tailwind Dark Mode */
        .dark .dark-mode-off { display: none; }
        .dark-mode-on { display: none; }
        .dark .dark-mode-on { display: inline-block; }
    </style>
    
    <script>
        // Initialize Tailwind dark mode
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
</head>
<body class="bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200">

<nav class="bg-white dark:bg-gray-800 p-4 flex justify-between items-center shadow-lg sticky top-0 z-50">
    <a class="text-2xl font-bold text-purple-600 dark:text-purple-400 tracking-wide" href="{{ url_for('index') }}">TDH</a>
    <div class="flex items-center gap-2 md:gap-4">
        <button id="theme-toggle" type="button" class="p-2 rounded-full w-9 h-9 flex items-center justify-center text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
            <i class="fa-solid fa-sun dark-mode-off"></i>
            <i class="fa-solid fa-moon dark-mode-on"></i>
        </button>
        <a href="mailto:support@tdh.org" class="p-2 rounded-full w-9 h-9 flex items-center justify-center border border-gray-300 dark:border-gray-600 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors" title="البريد الإلكتروني">
            <i class="fa-solid fa-envelope"></i>
        </a>
        <a href="https://www.tdh.org" target="_blank" class="p-2 rounded-full w-9 h-9 flex items-center justify-center border border-gray-300 dark:border-gray-600 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors" title="الموقع الرسمي">
            <i class="fa-solid fa-globe"></i>
        </a>
        <a href="tel:+201234567890" class="p-2 rounded-full w-9 h-9 flex items-center justify-center border border-gray-300 dark:border-gray-600 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors" title="خدمة العملاء">
            <i class="fa-solid fa-phone"></i>
        </a>
        <a href="{{ url_for('index') }}" class="px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 font-medium hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-sm">الرئيسية</a>
        <a href="{{ url_for('centers') }}" class="px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 font-medium hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-sm">مراكز</a>
        <a href="{{ url_for('logout') }}" class="px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 font-medium hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-sm">خروج</a>
    </div>
</nav>

<div class="flex items-center justify-center min-h-[calc(100vh-6rem)] p-4">
    <div class="w-full max-w-xl bg-white dark:bg-gray-800 p-8 rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700">
        <h2 class="text-3xl font-bold text-center mb-6 text-purple-600 dark:text-purple-400">الملف الشخصي</h2>
        
        <div class="mb-6 border-b border-gray-200 dark:border-gray-700 pb-4">
            <p class="text-lg">
                <span class="font-bold text-gray-600 dark:text-gray-300">اسم المستخدم:</span> 
                <span class="text-blue-600 dark:text-blue-400">{{ user.username }}</span>
            </p>
        </div>
        
        <form method="POST" class="mb-6">
            <div class="mb-4">
                <label for="training_course" class="block text-gray-500 dark:text-gray-400 text-sm font-semibold mb-2">اسم الدورة التدريبية</label>
                <input id="training_course" name="training_course" type="text" class="w-full px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg border border-gray-300 dark:border-gray-600 focus:outline-none focus:border-purple-500 transition-colors" value="{{ user.training_course or '' }}">
            </div>
            <button name="update_course" type="submit" class="w-full py-3 rounded-lg text-lg text-white font-bold bg-green-600 hover:bg-green-700 transition-colors duration-300">
                <i class="fa-solid fa-check ml-2"></i>تحديث
            </button>
        </form>

        <form method="POST" onsubmit="return confirm('هل أنت متأكد من حذف الحساب؟ لا يمكن التراجع!');">
            <button name="delete_account" type="submit" class="w-full py-3 rounded-lg text-lg text-white font-bold bg-red-600 hover:bg-red-700 transition-colors duration-300">
                <i class="fa-solid fa-trash-alt ml-2"></i> حذف الحساب
            </button>
        </form>

        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="mt-4">
              {% for category, message in messages %}
                <div class="py-2 px-4 rounded-lg text-sm text-green-200 dark:text-green-300 bg-green-800/50 dark:bg-green-900/50">
                    {{ message }}
                </div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}
    </div>
</div>

<script>
    // Dark/Light Mode Toggle Script
    const themeToggleBtn = document.getElementById('theme-toggle');
    const htmlElement = document.documentElement;

    // Function to apply the saved theme
    function applyTheme(theme) {
        if (theme === 'dark') {
            htmlElement.classList.add('dark');
        } else {
            htmlElement.classList.remove('dark');
        }
    }

    // Check for saved theme in localStorage or system preference
    const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    applyTheme(savedTheme);

    // Event listener for the toggle button
    themeToggleBtn.addEventListener('click', () => {
        const isDark = htmlElement.classList.toggle('dark');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });
</script>

</body>
</html>